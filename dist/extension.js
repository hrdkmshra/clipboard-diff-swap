"use strict";var l=Object.create;var a=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty;var m=(e,o)=>{for(var n in o)a(e,n,{get:o[n],enumerable:!0})},c=(e,o,n,d)=>{if(o&&typeof o=="object"||typeof o=="function")for(let r of u(o))!v.call(e,r)&&r!==n&&a(e,r,{get:()=>o[r],enumerable:!(d=f(o,r))||d.enumerable});return e};var b=(e,o,n)=>(n=e!=null?l(p(e)):{},c(o||!e||!e.__esModule?a(n,"default",{value:e,enumerable:!0}):n,e)),E=e=>c(a({},"__esModule",{value:!0}),e);var S={};m(S,{activate:()=>P,deactivate:()=>N});module.exports=E(S);var t=b(require("vscode")),i={currentClipboardContent:"",originalEditor:void 0,clipboardDocument:void 0,contentProvider:void 0},w="clipboardDiffSwap",g="editableClipboard",C=1e3;function P(e){let o=t.commands.registerCommand("clipboard-swap.compareWithClipboard",async()=>{try{await D()}catch(n){let d=n instanceof Error?n.message:"Unknown error occurred";t.window.showErrorMessage(`Clipboard Diff Swap: ${d}`)}});e.subscriptions.push(o)}async function D(){await s();let e=await x();if(!e)return;let o=await h();if(!o)return;i.originalEditor=e,i.currentClipboardContent=o,y()?await T():await M()}async function x(){let e=t.window.activeTextEditor;if(!e){let o=t.window.visibleTextEditors;if(o.length>0)e=o[0];else{t.window.showErrorMessage("No open files found. Please open a file first.");return}}return e}async function h(){let e=await t.env.clipboard.readText();if(!e.trim()){t.window.showErrorMessage("Clipboard is empty. Please copy some text first.");return}return e}function y(){return t.workspace.getConfiguration(w).get(g,!1)}async function T(){if(i.originalEditor)try{i.clipboardDocument=await t.workspace.openTextDocument({content:i.currentClipboardContent,language:i.originalEditor.document.languageId});let e=t.workspace.asRelativePath(i.originalEditor.document.uri);await t.commands.executeCommand("vscode.diff",i.originalEditor.document.uri,i.clipboardDocument.uri,`${e} \u2194 Clipboard (Editable)`)}catch(e){let o=e instanceof Error?e.message:"Failed to create editable diff";t.window.showErrorMessage(`Clipboard Diff Swap: ${o}`)}}async function M(){if(i.originalEditor)try{let e=t.Uri.parse(`clipboard:content-${Date.now()}`);i.contentProvider=t.workspace.registerTextDocumentContentProvider("clipboard",{provideTextDocumentContent:()=>i.currentClipboardContent});let o=t.workspace.asRelativePath(i.originalEditor.document.uri);await t.commands.executeCommand("vscode.diff",i.originalEditor.document.uri,e,`${o} \u2194 Clipboard (Read-only)`),setTimeout(()=>{i.contentProvider&&(i.contentProvider.dispose(),i.contentProvider=void 0)},C)}catch(e){let o=e instanceof Error?e.message:"Failed to create read-only diff";t.window.showErrorMessage(`Clipboard Diff Swap: ${o}`)}}async function s(){i.contentProvider&&(i.contentProvider.dispose(),i.contentProvider=void 0),i.currentClipboardContent="",i.originalEditor=void 0,i.clipboardDocument=void 0}function N(){s().catch(e=>{console.error("Error during extension deactivation:",e)})}0&&(module.exports={activate,deactivate});
